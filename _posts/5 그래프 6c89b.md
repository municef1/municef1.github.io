# 5. 그래프

## 그래프의 정의

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled.png)

## 그래프 예

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%201.png)

## 그래프의 활용

- 소셜 네트워크
- 대진표
- 웹사이트 링크 관계도
- 연구 인용 관계도
- 분자 구조

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%202.png)

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%203.png)

## 그래프의 용어

- 인접 adjacent

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%204.png)

- 근접 incident

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%205.png)

- N(v) : 정점 v의 이웃 정점 집합
- 차수 degree
    
    d(v): 정점 v에 근접하는 모서리의 개수
    
    루프는 두 번으로 계산
    

## 그래프의 용어 예

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%206.png)

## 그래프의 형태

- 단순 그래프 simple graph
    - 두 정점 사이에 오직 하나의 모서리가 있는 그래프

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%207.png)

- 다중그래프 multi graph
    - 두 정점 사이에 둘 이상의 모서리가 있는 그래프

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%208.png)

- 의사그래프 pseudo graph
    - 루프를 허용하는 그래프

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%209.png)

- 가중치 그래프 weighted graph
    - 모서리에 가중치가 부여된 그래프

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2010.png)

### 방향성을 가지고 나눌 수도 있다.

- 비방향(무향)그래프 undirected graph
    
    ![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2011.png)
    

- 방향(유향) 그래프 directed graph

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2012.png)

## 특별한 그래프

- 순환 Cycle, Cn
    - n ≥ 3 인 n개 정점과 (v1, v2), (v2, v3), ... , (vn, v1)인 모서리로 이루어진 그래프

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2013.png)

## 그래프 개념 확인

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2014.png)

## 그래프의 표현

- 인접리스트 adjacency list
    - 각 정점에 인접하는 정점들을 리스트로 표현

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2015.png)

- 인접행렬 adjacency matrix : A
    - 그래프 G = ( V, E )에서 l V l = n 일 때, n * n 행렬 A = [ a_ij]

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2016.png)

## DAG : Directed Acyclic Graph

- 방향 비순환 그래프
    - 순환이 존재하지 않는 방향 그래프

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2017.png)

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2018.png)

## *중요* 뉴럴넷과 그래프

- 가중 방향 비순환 그래프 Weighted Directed Acyclic Graph

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2019.png)

## 가중치의 표현

- w_ij : j 입력 인덱스, i 출력 인덱스 입력

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2020.png)

- w_ij : i 입력 인덱스, j 출력 인덱스 입력
- (T를 취함)

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2021.png)

- 뒤죽박죽

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2022.png)

## *중요* 계산 그래프

- y = e^(2x+1)
- Directed Acyclic Graph
- Vertex : 변수, 연산
    
    ![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2023.png)
    
- Edge : 연산

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2024.png)

### 계산 그래프의 포워드 연산

- 포워드: 입력~출력까지 순서대로 변수를 계산하고 저장하는 과정
- 백워드는 각 뉴런의 기울기(그래디언트)를 계산하는 과정

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2025.png)

### 계산 그래프의 백워드 연산

- Q : 굳이 백워드 해야하는 이유?
    - A1. 역전파알고리즘은 미분계수를 구해 그래디언트를 구하기 위함.
    식이 정방향으로 진행되었을 경우 y와 같은 값이 나옴.
    실제 학습시에는 값들이 들어가 가중치를 업데이트하는데 사용됨.
    - A2. 인공신경망은 forward와 backward 두가지가 있습니다.
    그래디언트를 구하기 위함은 forward에서 진행된 오차를 구하기 위함이고 backward에서 그래디언트를 구하기 위해 역전파 알고리즘을 이용합니다.
    

## 연습 : 백워드 연산

```python
import numpy as np
```

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2026.png)

```python
def add(x, a):
    # WRITE CODE HERE [+]
    return x+a, 1

def mul(x, a):
    # WRITE CODE HERE [+]
    return a*x, a

def exp(x):
    # WRITE CODE HERE [+]
    return np.exp(x), np.exp(x)
```

```python
x0 = 1.5

# WRITE CODE HERE [+]
a, dx0 = mul(x0, 2)
b, da = add(a, 1)
y, db = exp(b)

print(f"f({x0})={y:.3f}")
print(f"f'({x0})={dx0*da*db:.3f}")
```

f(1.5)=54.598
f'(1.5)=109.196

```python
np.exp(2*x0+1), 2*np.exp(2*x0+1)
```

(54.598150033144236, 109.19630006628847)

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2027.png)

```python
import sympy as S
```

```python
x = S.Symbol('x')

y = (S.sqrt(x)/2 -1)**(-10)
y
```

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2028.png)

```python
dy = S.diff(y, x)
dy
```

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2029.png)

```python
x0 = 1
print(f"f({x0})={y.subs({x:x0})}" )
print(f"f'({x0})={dy.subs({x:x0})}" )
```

f(1)=1024
f'(1)=5120

```python
def pow(x, n):
    # WRITE CODE HERE [+]
    return x**n, n*x**(n-1)
```

```python
x0 = 1

# WRITE CODE HERE [+]
a, dx0 = pow(x0, (1/2))
b, da = mul(a, (1/2))
c, db = add(b, -1)
y, dc = pow(c, -10)

print(f"f({x0})={y}")
print(f"f'({x0})={dc*db*da*dx0}")
```

f(1)=1024.0
f'(1)=5120.0

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2030.png)

![Untitled](5%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%A2%E1%84%91%E1%85%B3%206c89b/Untitled%2031.png)